import scapy.all as scapy

def scan(ip, interface):
    # Set the interface to be used
    scapy.conf.iface = interface

    # Create ARP request
    arp_request = scapy.ARP(pdst=ip)
    broadcast = scapy.Ether(dst="ff:ff:ff:ff:ff:ff")
    arp_request_broadcast = broadcast / arp_request

    # Send and receive packets
    answered_list = scapy.srp(arp_request_broadcast, timeout=4, verbose=False)[0]



    client_list = []
    for element in answered_list:
        client_dict = {"IP": element[1].psrc, "MAC": element[1].hwsrc}
        client_list.append(client_dict)
    
    return client_list

def print_result(result_list):
    print("[+] this is the result of your scan:")

    print("IP\t\t\tMAC_address\n-------------------------")
    for client in result_list:
        print(client["IP"] + "\t\t" + client["MAC"])
    
    print("[+] finishing the scan")


print("[+] hello hacker, this program can scan any given network and return the mac and ip addresses of the clients connected to the network")

# Get IP range and interface from the user
ip = input("Enter an IP range to scan: ")
interface = input("Enter the network interface (e.g., wlan0, eth0): ")

# Call the scan function with user-specified interface
scan_result = scan(ip, interface)
print_result(scan_result)
